This is an alternative approach based on ADT with Type classes.
See explanations in  main README.md)